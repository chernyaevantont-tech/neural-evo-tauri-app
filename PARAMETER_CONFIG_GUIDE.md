# Руководство по настройке параметров нод

## Обзор

Визуальный редактор теперь поддерживает полную настройку параметров нод при их создании и редактировании. При изменении параметров существующей ноды создается **новый экземпляр класса** с обновленными параметрами, при этом все связи в графе автоматически восстанавливаются.

## Как использовать

### Добавление новой ноды с параметрами

1. Нажмите на одну из кнопок добавления ноды (например, "+ Dense")
2. Откроется модальное окно с настройками параметров
3. Настройте нужные параметры
4. Нажмите "Create" для создания ноды

### Редактирование существующей ноды

1. Выберите ноду на холсте (кликните на неё)
2. Нажмите кнопку "Edit Node" в панели инструментов
3. Откроется модальное окно с текущими параметрами ноды
4. Измените параметры
5. Нажмите "Update"
6. Создастся новый экземпляр ноды с новыми параметрами
7. Все входящие и исходящие связи автоматически восстановятся (если они совместимы)

## Параметры различных типов нод

### 1. Input Node (Входной слой)

Определяет форму входных данных.

**Параметры:**
- **Dimension 1** (обязательный): Первая размерность (например, высота изображения)
- **Dimension 2** (опциональный): Вторая размерность (например, ширина изображения)
- **Dimension 3** (опциональный): Третья размерность (например, количество каналов)

**Примеры:**
- `(28)` - одномерный вход (временной ряд)
- `(28, 28)` - двумерный вход (изображение в градациях серого)
- `(224, 224, 3)` - трехмерный вход (цветное RGB изображение)

### 2. Dense Node (Полносвязный слой)

Классический полносвязный (Dense/Fully Connected) слой.

**Параметры:**
- **Units**: Количество нейронов в слое (целое число > 0)
- **Activation**: Функция активации
  - `relu` - Rectified Linear Unit
  - `leaky_relu` - Leaky ReLU (предотвращает "умирание" нейронов)
  - `softmax` - Для классификации (обычно в выходном слое)
- **Use Bias**: Использовать ли bias (смещение) - обычно true

**Примеры:**
- Скрытый слой: `units=128, activation=relu, use_bias=true`
- Выходной слой для 10 классов: `units=10, activation=softmax, use_bias=true`

### 3. Conv2D Node (Сверточный слой)

Двумерный сверточный слой для обработки изображений.

**Параметры:**
- **Filters**: Количество фильтров (feature maps)
- **Kernel Height/Width**: Размер ядра свертки
  - Обычно 3x3 или 5x5
- **Stride**: Шаг свертки (обычно 1)
- **Padding**: Дополнение (padding)
  - 0 = valid (без padding)
  - 1 = same (сохраняет размер)
- **Dilation**: Расширение (dilation rate)
  - 1 = стандартная свертка
  - >1 = dilated convolution (увеличивает receptive field)
- **Use Bias**: Использовать ли bias

**Примеры:**
- Стандартная свертка: `filters=32, kernel=3x3, stride=1, padding=1, dilation=1`
- Dilated convolution: `filters=64, kernel=3x3, stride=1, padding=2, dilation=2`

### 4. Pooling Node (Слой пулинга)

Уменьшает пространственные размеры feature maps.

**Параметры:**
- **Pool Type**: Тип пулинга
  - `max` - Maximum pooling (берет максимум)
  - `avg` - Average pooling (берет среднее)
- **Kernel Height/Width**: Размер окна пулинга (обычно 2x2)
- **Stride**: Шаг пулинга (обычно равен размеру окна)
- **Padding**: Дополнение (обычно 0)

**Примеры:**
- Стандартный max pooling: `type=max, kernel=2x2, stride=2, padding=0`
- Overlapping pooling: `type=max, kernel=3x3, stride=2, padding=0`

### 5. Add Node (Слой сложения)

Поэлементно складывает входы (элемент residual connections).

**Параметры:** Нет настраиваемых параметров

**Требования:**
- Все входы должны иметь одинаковую форму

### 6. Concat2D Node (Слой конкатенации)

Объединяет входы по оси каналов (channel dimension).

**Параметры:** Нет настраиваемых параметров

**Требования:**
- Все входы должны иметь одинаковую высоту и ширину
- Отличаться могут только количества каналов

## Техническая реализация

### Пересоздание экземпляров при редактировании

При нажатии "Update" в режиме редактирования:

1. **Сохраняются связи**: Система запоминает все входящие и исходящие связи ноды
2. **Создается новый экземпляр**: Вызывается конструктор класса с новыми параметрами
3. **Восстанавливаются связи**: 
   - Для каждой входящей связи проверяется совместимость (`CheckCompability`)
   - Для каждой исходящей связи проверяется совместимость
   - Только совместимые связи восстанавливаются
   - Несовместимые связи удаляются

### Проверка совместимости

Каждая нода имеет метод `CheckCompability`, который проверяет:
- Соответствие размерностей (1D, 2D, 3D)
- Соответствие конкретных размеров shape (для AddNode и Concat2DNode)
- Другие специфичные для типа ноды требования

## Примеры использования

### Создание простой CNN архитектуры

1. Добавьте **Input Node**: `(28, 28, 1)` - изображение 28x28 в градациях серого
2. Добавьте **Conv2D**: `filters=32, kernel=3x3, stride=1, padding=1`
3. Добавьте **Pooling**: `max, kernel=2x2, stride=2`
4. Добавьте **Conv2D**: `filters=64, kernel=3x3, stride=1, padding=1`
5. Добавьте **Pooling**: `max, kernel=2x2, stride=2`
6. Добавьте **Dense**: `units=128, activation=relu`
7. Добавьте **Dense**: `units=10, activation=softmax` - выходной слой для 10 классов

Соедините их последовательно с помощью Shift+Click.

### Создание ResNet-подобной архитектуры с skip connections

1. Создайте основной путь: Input -> Conv2D -> Conv2D
2. Добавьте **Add Node**
3. Соедините выход первого Conv2D с Add Node (skip connection)
4. Соедините выход второго Conv2D с Add Node (main path)
5. Продолжайте строить архитектуру от Add Node

### Изменение параметров существующей ноды

Если вы хотите изменить количество фильтров в Conv2D слое:
1. Выберите Conv2D ноду
2. Нажмите "Edit Node"
3. Измените `filters` с 32 на 64
4. Нажмите "Update"
5. Новый экземпляр Conv2DNode создастся с 64 фильтрами
6. Все связи сохранятся автоматически

## Горячие клавиши

- **Click** - Выбрать ноду
- **Shift+Click** - Создать связь (первый клик - источник, второй - цель)
- **Drag** - Перемещение ноды

## Советы

1. **Начинайте с Input Node**: Всегда создавайте архитектуру с входного слоя
2. **Проверяйте совместимость**: Редактор не позволит создать несовместимые связи
3. **Используйте панель информации**: Выбирайте ноды, чтобы видеть их полную информацию
4. **Экспериментируйте**: При редактировании параметров несовместимые связи просто удалятся
5. **Shape tracking**: Система автоматически вычисляет выходную форму каждой ноды на основе входной

## Известные ограничения

1. При изменении параметров, которые делают связь несовместимой, эта связь будет удалена
2. Для Input Node обязательна только первая размерность
3. Некоторые комбинации параметров могут привести к недопустимым размерам (например, padding > kernel size)
